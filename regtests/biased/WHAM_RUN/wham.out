
  ##################################################################
  ##                                                              ##
  ##  WHAM-BASED CLUSTER ANALYSIS FOR BIAS-EXCHANGE METADYNAMICS  ##
  ##                                                              ##
  ##################################################################

!!!!!!!!!!!!!!!!!!  I N P U T   T E M P L A T E  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
KT     2.4                     ! temperature          (units of HILLS files)        !
T_FILL  40000. 40000.          ! fill and smooth time                               !
FILE_HILL  HILLS.A  1  1       ! Hill_file, with one biased variable, the first one !
FILE_HILL  HILLS.B  1  2       ! Hill_file, with one biased variable, the second one!
DELTA  2.                      ! align VG within 2 KT.                              !
NCV_ACTIVE  3                  ! number of active CVs                               !
RANGE_CV  1  0.0  1.0          ! restrict active CV 1 to range 0.0:1.0              !
RANGE_CV  2  0.5  2.0          ! restrict active CV 2 to range 0.5:2.0              !
RANGE_CV  3  -3.14 3.14        ! restrict active CV 2 to range -3.14:3.14           !
PERIODIC  3                    ! active CV 3 is periodic                            !
MIN_OVERLAP  2                 ! retain cluster if at least 2 walkers have NEFF>=1  !
NGRID        50                ! compute VG aligment on a grid of size 50           !
GCORR        10.               ! correlation time of n                              !
TR_N_EXP     10.               ! Threshold on the number of explored clusters       !
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
INPUT: KT 	 2.4943                                                           
INPUT: T_FILL  	 200. 	 200.                                                 
INPUT: DELTA 	 4                                                             
INPUT: GCORR 	 1                                                             
INPUT: TR_N_EXP 	 5                                                          
INPUT: FILE_HILL 	 HILLS0 	 1 	 1                                            
INPUT: FILE_HILL 	 HILLS1 	 1 	 2                                            
INPUT: FILE_HILL 	 HILLS2 	 1 	 3                                            
INPUT: NCV_ACTIVE 	 3                                                        
INPUT: RANGE_CV 1 -3.14159 3.14159                                           
INPUT: PERIODIC 1                                                            
INPUT: RANGE_CV 2 -3.14159 3.14159                                           
INPUT: PERIODIC 2                                                            
INPUT: RANGE_CV 3 -3.14159 3.14159                                           
INPUT: PERIODIC 3                                                            
INPUT: NGRID 	 50                                                            
INPUT: MIN_OVERLAP 1                                                         
INPUT: KT 	 2.4943                                                           
INPUT: T_FILL  	 200. 	 200.                                                 
INPUT: DELTA 	 4                                                             
INPUT: GCORR 	 1                                                             
INPUT: TR_N_EXP 	 5                                                          
INPUT: FILE_HILL 	 HILLS0 	 1 	 1                                            
INPUT: FILE_HILL 	 HILLS1 	 1 	 2                                            
INPUT: FILE_HILL 	 HILLS2 	 1 	 3                                            
INPUT: NCV_ACTIVE 	 3                                                        
INPUT: RANGE_CV 1 -3.14159 3.14159                                           
INPUT: PERIODIC 1                                                            
INPUT: RANGE_CV 2 -3.14159 3.14159                                           
INPUT: PERIODIC 2                                                            
INPUT: RANGE_CV 3 -3.14159 3.14159                                           
INPUT: PERIODIC 3                                                            
INPUT: NGRID 	 50                                                            
INPUT: MIN_OVERLAP 1                                                         
 HILLS0:#! ACTIVE 1 1 A
 nactive=           1  label=A                                                 
 HILLS1:#! ACTIVE 1 2 B
 nactive=           1  label=B                                                 
 HILLS2:#! ACTIVE 1 3 C
 nactive=           1  label=C                                                 
  reading cluster labels from file LABELS
  read       39596 cluster labels from file LABELS
  assigned cluster labels =    39596

 ::::::::::::::::: bias potentials VG :::::::::::::::::::::::

  HILLS0 :  nhills, CV frames, active CV =   5000    9901  1
  computing two VG profiles on the grid
  ..................................................  done
  aligning two VG profiles by
  maximizing # grid points connected to maximum in VG within DELTA*KT range
  grid points visited = 100.00 %
  ...................................................  done
  CCbest =  -7.98
  visited grid points within range = 100.00 %   connected = 100.00 %
  average error on the connected grid points:  0.28
  assigning VG to each frame
  good_frames = 98.12 %

  HILLS1 :  nhills, CV frames, active CV =   5000    9900  2
  computing two VG profiles on the grid
  ..................................................  done
  aligning two VG profiles by
  maximizing # grid points connected to maximum in VG within DELTA*KT range
  grid points visited = 100.00 %
  ...................................................  done
  CCbest =  -8.98
  visited grid points within range = 100.00 %   connected = 100.00 %
  average error on the connected grid points:  0.33
  assigning VG to each frame
  good_frames = 98.14 %

  HILLS2 :  nhills, CV frames, active CV =   5000    9898  3
  computing two VG profiles on the grid
  ..................................................  done
  aligning two VG profiles by
  maximizing # grid points connected to maximum in VG within DELTA*KT range
  grid points visited = 100.00 %
  ...................................................  done
  CCbest =  -7.98
  visited grid points within range = 100.00 %   connected = 100.00 %
  average error on the connected grid points:  0.21
  assigning VG to each frame
  good_frames = 98.18 %

 ::::::::::::::::: free energy of clusters from WHAM ::::::::

  computing VEFF and NEFF
           550 frames discarded
         29149 frames accepted
  cleaning from dirty clusters
         0 clusters discarded (not visited by enough walkers)
       200 clusters accepted
  rmsd (VEFF-VG_ave) =     2.708
  rmsd (VG-VG_ave)   =       NaN
    (if they are very different there is a problem)
  calculating f constants (shift of VG)
    iteration, f (units of HILLS file) :
    1000    2.89    8.95    3.59
    2000    2.89    8.95    3.59
    3000    2.89    8.95    3.59
    4000    2.89    8.95    3.59
    5000    2.89    8.95    3.59
    6000    2.89    8.95    3.59
    7000    2.89    8.95    3.59
    8000    2.89    8.95    3.59
    9000    2.89    8.95    3.59
   10000    2.89    8.95    3.59
  assigning free energy to clusters
  free-energy dispersion of clusters (units of HILLS files) =   24.33
  files FES and FES_ALLW written
    (contains: cluster F err)
    (contains: cluster S(1:NCV) F F_H(1:NH))
